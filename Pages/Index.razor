@page "/"
@inject InMemoryDbService Db
    <div id="index" class="container-fluid d-flex flex-column fade-down-in-1">
        <div class="row">
            <div class="col-1 d-flex flex-column justify-content-center">
                <svg class="@HideShowLeftArrow bi bi-chevron-compact-left" @onclick="ArrowLeft" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" d="M9.224 1.553a.5.5 0 01.223.67L6.56 8l2.888 5.776a.5.5 0 11-.894.448l-3-6a.5.5 0 010-.448l3-6a.5.5 0 01.67-.223z" clip-rule="evenodd" />
                </svg>
            </div>
            <div class="col-10 justify-content-center d-flex flex-column">
                <Whiteboard WOD="@WOD" 
                            Pregame="@Pregame" 
                            Metcon="@Metcon"
                            Completed="@(WOD.Completed ? "completed" : "")"
                            CardIsFlipped="@CardIsFlipped"/>
            </div>
            <div class="col-1 d-flex flex-column justify-content-center">
                <svg class="@HideShowRightArrow bi bi-chevron-compact-right" @onclick="ArrowRight" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" d="M6.776 1.553a.5.5 0 01.671.223l3 6a.5.5 0 010 .448l-3 6a.5.5 0 11-.894-.448L9.44 8 6.553 2.224a.5.5 0 01.223-.671z" clip-rule="evenodd" />
                </svg>
            </div>
        </div>
    </div>

@code {
    private WOD WOD;

    private Pregame Pregame;

    private Metcon Metcon;

    private string HideShowLeftArrow;

    private string HideShowRightArrow;

    private bool CardIsFlipped = false;

    protected override async void OnInitialized()
    {
        WOD = await Db.GetCurrentWOD();
        Pregame = await Db.GetPregame(WOD.PregameId);
        Metcon = await Db.GetMetcon(WOD.MetconId);
        HideShowLeftArrow = await Db.GetWOD(WOD.Id + 1) == null ? "d-none" : "";
        HideShowRightArrow = await Db.GetWOD(WOD.Id - 1) == null ? "d-none" : "";
    }

    private async void ArrowLeft()
    {
        WOD = await Db.GetWOD(WOD.Id + 1);
        Pregame = await Db.GetPregame(WOD.PregameId);
        Metcon = await Db.GetMetcon(WOD.MetconId);
        HideShowLeftArrow = await Db.GetWOD(WOD.Id + 1) == null ? "d-none" : "";
        HideShowRightArrow = await Db.GetWOD(WOD.Id - 1) == null ? "d-none" : "";
        CardIsFlipped = false;
    }

    private async void ArrowRight()
    {
        WOD = await Db.GetWOD(WOD.Id - 1);
        Pregame = await Db.GetPregame(WOD.PregameId);
        Metcon = await Db.GetMetcon(WOD.MetconId);
        HideShowLeftArrow = await Db.GetWOD(WOD.Id + 1) == null ? "d-none" : "";
        HideShowRightArrow = await Db.GetWOD(WOD.Id - 1) == null ? "d-none" : "";
        CardIsFlipped = false;
    }
}